{% comment %}
  Product Breadcrumb Section Settings:
  - Enable/Disable collection display
  - Show/Hide next/previous product links  
  - Configure go back URL
{% endcomment %}

<div class="breadcrumb-sec section-{{ section.id }}-padding color-{{ section.settings.color_scheme }}">
    <div class="{{ section.settings.width }}">
        <div class="breadcrumb-wrap">
            <div class="breadcrumb-list" itemscope itemtype="https://schema.org/BreadcrumbList">
                <a class="breadcrumb-item" style="color: rgb(var(--color-foreground2));" href="/" itemprop="itemListElement" itemscope itemtype="https://schema.org/BreadcrumbListItem">
                    <span itemprop="name">{{ 'general.breadcrumbs.home' | t | default: 'Home' }}</span>
                    <meta itemprop="position" content="1" />
                </a>
                
                {% if section.settings.show_collection and product.collections.size > 0 %}
                    {% assign primary_collection = product.collections.first %}
                    <div class="breadcrumb-item dot"><span></span></div>
                    <a class="breadcrumb-item" style="color: rgb(var(--color-foreground2));" href="{{ primary_collection.url }}" itemprop="itemListElement" itemscope itemtype="https://schema.org/BreadcrumbListItem">
                        <span itemprop="name">{{ primary_collection.title }}</span>
                        <meta itemprop="position" content="3" />
                    </a>
                {% endif %}
                
                <div class="breadcrumb-item dot"><span></span></div>
                <div class="breadcrumb-item current" style="color: rgb(var(--color-foreground ));" itemprop="itemListElement" itemscope itemtype="https://schema.org/BreadcrumbListItem">
                    <span itemprop="name">{{ product.title }}</span>
                    <meta itemprop="position" content="{% if section.settings.show_collection and product.collections.size > 0 %}4{% else %}3{% endif %}" />
                </div>
            </div>
            
            {% if section.settings.show_navigation %}
                {% assign current_collection = product.collections.first %}
                
                <div class="breadcrumb-prev-next">
                    {% if current_collection %}
                        {% comment %} Find previous and next products in the collection {% endcomment %}
                        {% assign found_current = false %}
                        {% assign previous_product = nil %}
                        {% assign next_product = nil %}
                        
                        {% for collection_product in current_collection.products %}
                            {% if found_current %}
                                {% assign next_product = collection_product %}
                                {% break %}
                            {% endif %}
                            
                            {% if collection_product.id == product.id %}
                                {% assign found_current = true %}
                            {% else %}
                                {% assign previous_product = collection_product %}
                            {% endif %}
                        {% endfor %}
                        
                        {% if previous_product %}
                            <a href="{{ previous_product.url }}" class="breadcrumb-prev" title="{{ previous_product.title }}">
                                <i class="icon icon-arr-left"></i>
                            </a>
                        {% endif %}
                        
                        <a href="{{ section.settings.go_back_url }}" class="breadcrumb-back" title="{{ 'general.navigation.shop' | t | default: 'Shop' }}">
                            <i class="icon icon-grid"></i>
                        </a>
                        
                        {% if next_product %}
                            <a href="{{ next_product.url }}" class="breadcrumb-next" title="{{ next_product.title }}">
                                <i class="icon icon-arr-right2"></i>
                            </a>
                        {% endif %}
                    {% else %}
                        <span class="breadcrumb-prev disabled"><i class="icon icon-arr-left"></i></span>
                        <a href="{{ section.settings.go_back_url }}" class="breadcrumb-back" title="{{ 'general.navigation.shop' | t | default: 'Shop' }}">
                            <i class="icon icon-grid"></i>
                        </a>
                        <span class="breadcrumb-next disabled"><i class="icon icon-arr-right2"></i></span>
                    {% endif %}
                </div>
            {% endif %}
        </div>
    </div>
</div>
<style>
.section-{{ section.id }}-padding {
    padding-top: calc({{ section.settings.padding_top }}px * {{ section.settings.padding_mobile_rate | divided_by: 100.0 }});
    padding-bottom: calc({{ section.settings.padding_bottom }}px * {{ section.settings.padding_mobile_rate | divided_by: 100.0 }});
}
.breadcrumb-item {
    line-height: 1.6;
}
    
@media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top }}px;
    padding-bottom: {{ section.settings.padding_bottom }}px;
    }
}
</style>

{% schema %}
{
  "name": "Product Breadcrumb",
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:sections.all.colors.label",
      "default": "scheme-1"
    },
    {
      "type": "select",
      "id": "width",
      "label": "t:sections.all.width.label",
      "options": [
        {
          "value": "container",
          "label": "t:sections.all.width.options.boxed"
        },
        {
          "value": "container-full",
          "label": "t:sections.all.width.options.full_width"
        }
      ],
      "default": "container"
    },
    {
      "type": "header",
      "content": "t:sections.product-breadcrumb.settings.breadcrumb_settings.content"
    },
    {
      "type": "checkbox",
      "id": "show_collection",
      "label": "t:sections.product-breadcrumb.settings.show_collection.label",
      "default": true
    },
    {
      "type": "checkbox", 
      "id": "show_navigation",
      "label": "t:sections.product-breadcrumb.settings.show_navigation.label",
      "default": true
    },
    {
      "type": "url",
      "id": "go_back_url",
      "label": "t:sections.product-breadcrumb.settings.go_back_url.label",
      "default": "/collections"
    },
    {
        "type": "header",
        "content": "t:sections.all.padding.section_padding_heading"
    },
    {
        "type": "range",
        "id": "padding_top",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "t:sections.all.padding.padding_top",
        "default": 0
    },
    {
        "type": "range",
        "id": "padding_bottom",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "t:sections.all.padding.padding_bottom",
        "default": 0
    },
    {
      "type": "range",
      "id": "padding_mobile_rate",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "%",
      "label": "t:sections.all.padding.padding_mobile_rate.label",
      "default": 75,
      "info": "t:sections.all.padding.padding_mobile_rate.info"
    }
  ],
  "presets": [
    {
      "name": "Product Breadcrumb"
    }
  ]
}
{% endschema %}