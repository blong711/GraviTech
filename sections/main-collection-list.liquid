<!-- Section Collection List -->
{%- liquid
  assign collection_display = section.settings.collection_display
  assign items_per_row_desktop = section.settings.items_per_row_desktop
  assign items_per_row_tablet = section.settings.items_per_row_tablet
  assign items_per_row_mobile = section.settings.items_per_row_mobile
  assign max_items = section.settings.max_items_to_show
  assign enable_uppercase = section.settings.enable_uppercase
  assign content_position = section.settings.content_position
  assign image_ratio = section.settings.image_ratio
  assign pagination_type = section.settings.pagination_type
  assign pagination_position = section.settings.pagination_position
  assign padding_top = section.settings.padding_top
  assign padding_bottom = section.settings.padding_bottom
  assign padding_mobile_rate = section.settings.padding_mobile_rate

  assign collections = collections
  case collection_display
    when 'selected'
      assign collections = section.settings.collection_list
      if collections == blank
        assign collections = section.blocks
      endif
  endcase
-%}

<style>
  .collection-list-{{ section.id }} {
    --items-per-row-desktop: {{ items_per_row_desktop }};
    --items-per-row-tablet: {{ items_per_row_tablet }};
    --items-per-row-mobile: {{ items_per_row_mobile }};
    padding-top: {{ padding_top }}px;
    padding-bottom: {{ padding_bottom }}px;
  }
  .collection-list-{{ section.id }} .tf-grid-layout {
    grid-template-columns: repeat(var(--items-per-row-mobile), 1fr);
    gap: 20px;
  }
  @media (min-width: 768px) {
    .collection-list-{{ section.id }} .tf-grid-layout {
      grid-template-columns: repeat(var(--items-per-row-tablet), 1fr);
    }
  }
  @media (min-width: 1200px) {
    .collection-list-{{ section.id }} .tf-grid-layout {
      grid-template-columns: repeat(var(--items-per-row-desktop), 1fr);
    }
  }
  @media (max-width: 767px) {
    .collection-list-{{ section.id }} {
      padding-top: calc({{ padding_top }}px * {{ padding_mobile_rate }} / 100);
      padding-bottom: calc({{ padding_bottom }}px * {{ padding_mobile_rate }} / 100);
    }
  }
  .collection-list-{{ section.id }} .image img {
    {%- if image_ratio == 'adapt_image' -%}
      width: 100%;
      height: auto;
    {%- elsif image_ratio == 'square' -%}
      aspect-ratio: 1 / 1;
    {%- elsif image_ratio == 'portrait' -%}
      aspect-ratio: 3 / 4;
    {%- elsif image_ratio == 'landscape' -%}
      aspect-ratio: 4 / 3;
    {%- elsif image_ratio == 'asos' -%}
      aspect-ratio: 2 / 3;
    {%- endif -%}
    object-fit: cover;
  }
</style>

{%- paginate collections by max_items -%}
  <section class="collection-list-{{ section.id }} color-{{ section.settings.color_scheme }}">
    <div class="{% if section.settings.width == 'boxed' %}container{% else %}container-full{% endif %}">
      <div class="flat-wrap-cls tf-grid-layout">
        {%- if collection_display == 'all' -%}
          {%- for collection in collections -%}
            {%- render 'collection-item',
              collection: collection,
              content_position: content_position,
              enable_uppercase: enable_uppercase,
              image_ratio: image_ratio,
              button_text: section.settings.button_text
            -%}
          {%- endfor -%}
        {%- elsif collection_display == 'selected' -%}
          {%- for collection in collections -%}
            {%- render 'collection-item',
              collection: collection,
              content_position: content_position,
              enable_uppercase: enable_uppercase,
              image_ratio: image_ratio,
              button_text: section.settings.button_text
            -%}
          {%- endfor -%}
        {%- endif -%}

        {%- comment -%} Render collection_item blocks if they exist {%- endcomment -%}
        {%- for block in section.blocks -%}
          {%- if block.type == 'collection_item' and block.settings.collection != blank -%}
            {%- render 'collection-item',
              collection: block.settings.collection,
              content_position: content_position,
              enable_uppercase: enable_uppercase,
              image_ratio: image_ratio,
              button_text: section.settings.button_text
            -%}
          {%- endif -%}
        {%- endfor -%}

        {%- if pagination_type != 'none' and paginate.pages > 1 -%}
          <!-- Pagination -->
          {%- if pagination_type == 'numbers' -%}
            <ul class="wg-pagination" style="justify-content: {{ pagination_position }} !important;">
              {%- if paginate.previous -%}
                <li>
                  <a href="{{ paginate.previous.url }}" class="pagination-item">
                    <i class="icon-arr-left"></i>
                  </a>
                </li>
              {%- endif -%}

              {%- for part in paginate.parts -%}
                {%- if part.is_link -%}
                  <li>
                    <a href="{{ part.url }}" class="pagination-item">{{ part.title }}</a>
                  </li>
                {%- else -%}
                  {%- if part.title == paginate.current_page -%}
                    <li class="active">
                      <div class="pagination-item">{{ part.title }}</div>
                    </li>
                  {%- else -%}
                    <li>
                      <span class="pagination-item">{{ part.title }}</span>
                    </li>
                  {%- endif -%}
                {%- endif -%}
              {%- endfor -%}

              {%- if paginate.next -%}
                <li>
                  <a href="{{ paginate.next.url }}" class="pagination-item">
                    <i class="icon-arr-right2"></i>
                  </a>
                </li>
              {%- endif -%}
            </ul>
          {%- endif -%}
        {%- endif -%}
      </div>
    </div>
  </section>
{%- endpaginate -%}

<!-- /Section Collection List -->


{% schema %}
{
  "name": "t:sections.main_collection_list.name",
  "tag": "section",
  "class": "section-collection-list",
  "settings": [
    {
      "type": "select",
      "id": "width",
      "label": "t:sections.main_collection_list.settings.width.label",
      "options": [
        {
          "value": "full",
          "label": "t:sections.main_collection_list.settings.width.options.full"
        },
        {
          "value": "boxed",
          "label": "t:sections.main_collection_list.settings.width.options.boxed"
        }
      ],
      "default": "boxed"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:sections.main_collection_list.settings.color_scheme.label",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "t:sections.main_collection_list.settings.main_collections_list.content"
    },
    {
      "type": "radio",
      "id": "collection_display",
      "label": "t:sections.main_collection_list.settings.collection_display.label",
      "options": [
        {
          "value": "all",
          "label": "t:sections.main_collection_list.settings.collection_display.options.all"
        },
        {
          "value": "selected",
          "label": "t:sections.main_collection_list.settings.collection_display.options.selected"
        }
      ],
      "default": "selected"
    },
    {
      "type": "header",
      "content": "t:sections.main_collection_list.settings.section_settings.content"
    },
    {
      "id": "collection_list",
      "type": "collection_list",
      "label": "t:sections.main_collection_list.settings.collection_list.label",
      "info": "t:sections.main_collection_list.settings.collection_list.info"
    },
    {
      "type": "range",
      "id": "max_items_to_show",
      "min": 2,
      "max": 50,
      "step": 1,
      "label": "t:sections.main_collection_list.settings.max_items_to_show.label",
      "default": 12
    },
    {
      "type": "header",
      "content": "t:sections.main_collection_list.settings.padding.content"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "t:sections.main_collection_list.settings.padding_top.label",
      "min": 0,
      "max": 120,
      "step": 4,
      "unit": "px",
      "default": 40
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "t:sections.main_collection_list.settings.padding_bottom.label",
      "min": 0,
      "max": 120,
      "step": 4,
      "unit": "px",
      "default": 40
    },
    {
      "type": "range",
      "id": "padding_mobile_rate",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "%",
      "label": "t:sections.main_collection_list.settings.padding_mobile_rate.label",
      "default": 75,
      "info": "t:sections.main_collection_list.settings.padding_mobile_rate.info"
    },
    {
      "type": "header",
      "content": "t:sections.main_collection_list.settings.width_settings.content"
    },
    {
      "type": "range",
      "id": "items_per_row_desktop",
      "min": 2,
      "max": 6,
      "step": 1,
      "label": "t:sections.main_collection_list.settings.items_per_row_desktop.label",
      "default": 3
    },
    {
      "type": "range",
      "id": "items_per_row_tablet",
      "min": 2,
      "max": 4,
      "step": 1,
      "label": "t:sections.main_collection_list.settings.items_per_row_tablet.label",
      "default": 2
    },
    {
      "type": "range",
      "id": "items_per_row_mobile",
      "min": 1,
      "max": 3,
      "step": 1,
      "label": "t:sections.main_collection_list.settings.items_per_row_mobile.label",
      "default": 1
    },
    {
      "type": "header",
      "content": "t:sections.main_collection_list.settings.options_for_collection_items.content"
    },
    {
      "type": "checkbox",
      "id": "enable_uppercase",
      "label": "t:sections.main_collection_list.settings.enable_uppercase.label",
      "default": false
    },
    {
      "type": "select",
      "id": "content_position",
      "label": "t:sections.main_collection_list.settings.content_position.label",
      "options": [
        {
          "value": "left",
          "label": "t:sections.main_collection_list.settings.content_position.options.left"
        },
        {
          "value": "center",
          "label": "t:sections.main_collection_list.settings.content_position.options.center"
        },
        {
          "value": "right",
          "label": "t:sections.main_collection_list.settings.content_position.options.right"
        }
      ],
      "default": "center"
    },
    {
      "type": "select",
      "id": "image_ratio",
      "label": "t:sections.main_collection_list.settings.image_ratio.label",
      "options": [
        {
          "value": "adapt_image",
          "label": "t:sections.main_collection_list.settings.image_ratio.options.adapt_image"
        },
        {
          "value": "square",
          "label": "t:sections.main_collection_list.settings.image_ratio.options.square"
        },
        {
          "value": "portrait",
          "label": "t:sections.main_collection_list.settings.image_ratio.options.portrait"
        },
        {
          "value": "asos",
          "label": "t:sections.main_collection_list.settings.image_ratio.options.asos"
        },
        {
          "value": "landscape",
          "label": "t:sections.main_collection_list.settings.image_ratio.options.landscape"
        }
      ],
      "default": "adapt_image"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "t:sections.main_collection_list.settings.button_text.label",
      "default": "t:sections.main_collection_list.settings.button_text.default"
    },
    {
      "type": "header",
      "content": "t:sections.main_collection_list.settings.collection_layout.content"
    },
    {
      "type": "select",
      "id": "pagination_type",
      "label": "t:sections.main_collection_list.settings.pagination_type.label",
      "info": "t:sections.main_collection_list.settings.pagination_type.info",
      "options": [
        {
          "value": "none",
          "label": "t:sections.main_collection_list.settings.pagination_type.options.none"
        },
        {
          "value": "numbers",
          "label": "t:sections.main_collection_list.settings.pagination_type.options.numbers"
        }
      ],
      "default": "none"
    },
    {
      "type": "select",
      "id": "pagination_position",
      "label": "t:sections.main_collection_list.settings.pagination_position.label",
      "options": [
        {
          "value": "left",
          "label": "t:sections.main_collection_list.settings.pagination_position.options.left"
        },
        {
          "value": "center",
          "label": "t:sections.main_collection_list.settings.pagination_position.options.center"
        },
        {
          "value": "right",
          "label": "t:sections.main_collection_list.settings.pagination_position.options.right"
        }
      ],
      "default": "center"
    }
  ],
  "blocks": [
    {
      "type": "collection_item",
      "name": "t:sections.main_collection_list.blocks.collection_item.name",
      "settings": [
        {
          "type": "collection",
          "id": "collection",
          "label": "t:sections.main_collection_list.blocks.collection_item.settings.collection.label"
        },
        {
          "type": "image_picker",
          "id": "collection_image",
          "label": "t:sections.main_collection_list.blocks.collection_item.settings.collection_image.label",
          "info": "t:sections.main_collection_list.blocks.collection_item.settings.collection_image.info"
        },
        {
          "type": "text",
          "id": "collection_title",
          "label": "t:sections.main_collection_list.blocks.collection_item.settings.collection_title.label",
          "info": "t:sections.main_collection_list.blocks.collection_item.settings.collection_title.info"
        },
        {
          "type": "url",
          "id": "collection_link",
          "label": "t:sections.main_collection_list.blocks.collection_item.settings.collection_link.label",
          "info": "t:sections.main_collection_list.blocks.collection_item.settings.collection_link.info"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "t:sections.main_collection_list.presets.name"
    }
  ]
}
{% endschema %}
