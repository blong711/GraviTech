{% comment %}
  Currency Selector Snippet
  Renders currency selector dropdown
  Accepts: form_id - unique identifier for the form to avoid duplicate IDs
{% endcomment %}

{%- assign form_id = form_id | default: 'CurrencyForm' -%}

{%- form 'localization', id: form_id, class: 'localization-form' -%}
  <div class="no-js-hidden">
    <select
      name="country_code"
      id="currency-selector-{{ form_id | handleize }}"
      class="image-select center style-default type-currencies"
      aria-labelledby="CurrencyLabel"
    >
      {%- assign current_country = localization.country.iso_code -%}
      {%- for country in localization.available_countries -%}
        <option
          value="{{ country.iso_code }}"
          {% if country.iso_code == current_country %}
            selected
          {% endif %}
          data-thumbnail="{{ 'https://cdn.jsdelivr.net/npm/flag-icons/flags/4x3/' | append: country.iso_code | downcase | append: '.svg' }}"
        >
          {{ country.currency.iso_code }}
        </option>
      {%- endfor -%}
    </select>
  </div>
  <input type="hidden" name="return_to" value="{{ request.path }}">
{%- endform -%}
